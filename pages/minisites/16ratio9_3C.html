
{{"extend": "minisites/index.html"}}
{$latestexhibitions = $scope.latest}

{block name=title}
  <h2 class="page_title">{$minisite_pageObj.page_title}</h2>    
{/block}

{block name=content}
<style>
  .frame-square {
    display:block;
    width: 100%;
    overflow: hidden;
    position: relative;
  }

  .ratio169{
  	padding-top: 56.25%;
  }
  .frame-square img {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0px;
      right: 0px;
      bottom: 0px;
      left: 0px;
      object-fit: cover;
  }
</style>
{$data = json_decode($minisite_pageObj.data, TRUE)}
{if ($data.show_current)} {$current = 'current'} {/if}
{if ($data.show_past)} {$past = 'past'} {/if}
{if ($data.show_future)} {$future = 'future'} {/if}
{$index = 0} {$count = 0}
<div class="row">
  <div class="photo-grid-row col-md-12">
    <ul class="photo-grid gallery-list row">
      {foreach from=$exhibitions item=exhibition}
        {if (($exhibition.current == $future) || ($exhibition.current == $current) || ($exhibition.current == $past))}
          <li class="photo-grid-container gallery-list-item pdf-thumb-box gallery-artwork-item col-sm-4" data-index="{$index}">
             <figure id="{$exhibition.id}" data-sharer_id="{$scope.user_id}" data-index="{$index}" class="__vp-plugin-container vp-loader-photoswipe">         
              <div class="__vp-flip-container" ontouchstart="this.classList.toggle('hover');">           
                <div class="__vp-flipper">             
                <div class="__vp-flip-front"> 
                  <span class="frame-square ratio169">              
                    <img class="__vp-plugin-image center-cropped" src="{$exhibition|collection_photo:'medium'}"  alt="{$exhibition.name}">  
                  </span>           
                </div>             
                <div class="__vp-flip-back __vp-plugin-hover">  
                  <span class="frame-square ratio169">             
                    <img class="__vp-flip-back-image" src="{$exhibition|collection_photo:'medium'}" alt="{$exhibition.name}">  
                  </span>             
                  <div class="__vp-flip-back-card"> 
                  <a href="{$basepath}/{$exhibition.page_slug}/{$exhibition.slug}">                
                    <h2>{$exhibition.title}</h2>   
                    <div class="mt10">{$exhibition|artists}</div> 
                    <div>{$exhibition.start_date|date_format:"%e %b %Y"} - {$exhibition.end_date|date_format:"%e %b %Y"}</div>    
                  </a>               
                  </div>                                                                
                </div>           
                </div>         
              </div> 
              {{"include": "minisites/exh_details.html"}}       
            </figure>
          </li>
          {$count = 1} {$index = $index + 1}
        {/if}
      {/foreach}
    </ul>
  </div>
</div>
{if (($data.show_latest) && (!$count))}
  <h4 style="text-align: left;">Latest</h4>
  <div class="row artists-row mobile-row artists-list-row artists-grid">
    {foreach from=$latestexhibitions item=exhibition}    
      <div class="col-lg-3 col-md-4 col-sm-6 col-xs-12 text-left artist-grid-col">
        <div class="image-container">  
          <a href="{$basepath}/{$exhibition.page_slug}/{$exhibition.slug}">
            <img src="{$exhibition|collection_photo:'medium'}" class="img-responsive" alt="{$exhibition.name} Exhibition">
          </a>
        </div>
        {{"include": "minisites/exh_details.html"}} 
      </div>   
      {$count = 1}
    {/foreach}
  </div> 
{/if}

<script src='https://cdnjs.cloudflare.com/ajax/libs/masonry/3.3.2/masonry.pkgd.min.js'></script>
<script>
  jQuery(window).on('load', function() {
  
    $('.item-container').masonry({
    columnWidth : '.item-grid-sizer',
    gutter : 15,
    itemSelector : '.item-grid',
    percentPosition : 'true',
    fitWidth: true,
    });
    
  });
</script>
{/block}